<script type="module">
  import * as THREE from '/assets/js/threejs/three.module.min.js';

  function init() {
  const container = document.getElementById('viewport');

  // 1. Create the renderer and set its size to the container's current size
  const renderer = new THREE.WebGLRenderer({ antialias: true });
  renderer.setSize(container.clientWidth, container.clientHeight);

  // 2. Append the renderer’s DOM element (a <canvas>) into the container div
  container.appendChild(renderer.domElement);

  // 3. Create a camera matching the container’s aspect ratio
  const camera = new THREE.PerspectiveCamera(
    75,
    container.clientWidth / container.clientHeight,
    0.1,
    1000
  );
  camera.position.z = 5;

  // 4. Create a scene & simple geometry (example: rotating cube)
  const scene = new THREE.Scene();
  
  const geometry = new THREE.BoxGeometry(1, 1, 1);
  const material = new THREE.MeshNormalMaterial();
  const cube = new THREE.Mesh(geometry, material);
  
  scene.add(cube);

  // 5. Animation loop
  function animate() {
    requestAnimationFrame(animate);

    // Some rotation
    cube.rotation.x += 0.01;
    cube.rotation.y += 0.01;

    renderer.render(scene, camera);
  }
  animate();

  // 6. Adjust if the container changes size – simplest is on window resize
  window.addEventListener('resize', onWindowResize);

  function onWindowResize() {
    // Update renderer & camera if container changes with window
    const w = container.clientWidth;
    const h = container.clientHeight;
    renderer.setSize(w, h);
    camera.aspect = w / h;
    camera.updateProjectionMatrix();
  }
}

document.addEventListener('DOMContentLoaded', init);
</script>